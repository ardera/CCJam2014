class "Villages" {
	config = {
		colortheme = {
			text = colors.orange,
			bg = colors.gray
		}
	},
	currentscreen = {},
	instance = {},
	fps = 20					-- more isn't possible
}

function Villages:draw()
	self.currentscreen:draw()
	dispose()
end

function Villages:update(ev)
	self.currentscreen:update(ev)
end

function Villages:main(gameargs)
	log "asdf"
	log "initializing game"
	
	Villages.instance = self
	bufferwrap.startup()
	self.currentscreen = ScreenMenue()
	self.running = true
	
	WorldelementList()
	
	log "initializing screen"
	
	self:update(Event("screen_initialization"))
	
	log "starting game loop"
	
	self.lastDraw = 0
	self.lastUpdate = 0
	
	log ("self.fps="..tostring(self.fps))
	local drawTimer = os.startTimer(1 / self.fps)
	local drawTimerStart = os.clock()

	while self.running do
		local ev = Event(os.pullEvent())
		if ev:is(Event.Timer) and ev:getDetail(1) == drawTimer then
			self:draw()
			self.lastDraw = os.clock()
			drawTimer = os.startTimer(1 / self.fps)
			drawTimerStart = os.clock()
		else
			self:update(ev)
			self.lastUpdate = os.clock()
		end
	end
end

function Villages:exit()
	self.running = false
end

function Villages:setScreen(s)
	self.currentscreen = s
end